<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="A colleague of mine, specifically from a different AV vendor, was poking around some files and was curious as to what these somewhat odd files where;VirusTotal Analysis Sha1: e4105ae117e62c784e26ae113">
<meta property="og:type" content="article">
<meta property="og:title" content="Javascript Malware Cross-Contamination in Android apks">
<meta property="og:url" content="https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/index.html">
<meta property="og:site_name" content="Strazzere">
<meta property="og:description" content="A colleague of mine, specifically from a different AV vendor, was poking around some files and was curious as to what these somewhat odd files where;VirusTotal Analysis Sha1: e4105ae117e62c784e26ae113">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2013-02-07T04:33:49.000Z">
<meta property="article:modified_time" content="2024-06-18T21:20:59.093Z">
<meta property="article:author" content="Tim Strazzere">
<meta property="article:tag" content="android">
<meta property="article:tag" content="malware">
<meta property="article:tag" content="com.android.settings">
<meta property="article:tag" content="cross-contamination">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="virustotal">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@timstrazz">
    
    
      
        
          
            <link rel="shortcut icon" href="https://www.gravatar.com/avatar/6a4b43066d19111e850cb14b45eacf93?s=48">
          
        
      
      
        
          
            <link rel="icon" type="image/png" href="https://www.gravatar.com/avatar/6a4b43066d19111e850cb14b45eacf93?s=192" sizes="192x192">
          
        
      
      
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="https://www.gravatar.com/avatar/6a4b43066d19111e850cb14b45eacf93?s=180">
          
        
      
    
    <!-- title -->
    <title>Javascript Malware Cross-Contamination in Android apks</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-166943540-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-166943540-1');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Strazzere" type="application/atom+xml" />
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/strazzere">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2013/02/loose-documentation-leads-to-easy-disassembler-breakages/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2012/08/android-zitmo-analysis-now-you-see-my-now-you-dont/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&text=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&is_video=false&description=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Javascript Malware Cross-Contamination in Android apks&body=Check out this article: https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&name=Javascript Malware Cross-Contamination in Android apks&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&t=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Javascript Malware Cross-Contamination in Android apks
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Tim Strazzere</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2013-02-07T04:33:49.000Z" class="dt-published" itemprop="datePublished">2013-02-06</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/android/">android</a> › <a class="category-link" href="/categories/android/reverse-engineering/">reverse engineering</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/android/" rel="tag">android</a>, <a class="p-category" href="/tags/com-android-settings/" rel="tag">com.android.settings</a>, <a class="p-category" href="/tags/cross-contamination/" rel="tag">cross-contamination</a>, <a class="p-category" href="/tags/javascript/" rel="tag">javascript</a>, <a class="p-category" href="/tags/malware/" rel="tag">malware</a>, <a class="p-category" href="/tags/virustotal/" rel="tag">virustotal</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>A colleague of mine, specifically from a different AV vendor, was poking around some files and was curious as to what these somewhat odd files where;<br><a target="_blank" rel="noopener" href="https://www.virustotal.com/file/6d55d46a988df08de85d066121be88f0837697793cd824bdc604b5368925950e/analysis/" title="VirusTotal Analysis Sha1: e4105ae117e62c784e26ae113a6119bd33a570cf">VirusTotal Analysis Sha1: e4105ae117e62c784e26ae113a6119bd33a570cf</a><br><a target="_blank" rel="noopener" href="https://www.virustotal.com/file/6849b9309300374b869fb9d9e11994bbdeff62017334d653e95ddb4d8e859974/analysis/" title="VirusTotal Analysis Sha1: 16111c45832a20914cfd9306501b406e2ae89b58">VirusTotal Analysis Sha1: 16111c45832a20914cfd9306501b406e2ae89b58</a><br>An apk (Android package) which is being detected by a ton of vendors, as having a javascript trojan dropper inside of it. Wait what? Is this some interesting new breed of Android malware, possibly leveraging <a target="_blank" rel="noopener" href="http://www.securelist.com/en/blog/805/Mobile_attacks">USB attacks</a> too!? Well, no - no it isn’t, it actually just is a curious case of cross-contamination. These files appear to be “infected” inside the embedded HTML files;</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">champagne:html tstrazzere$ grep -ir &quot;script&quot; * | less</span><br><span class="line">cs/tethering_help.html:</span><br><span class="line">cs/tethering\_usb\_help.html:</span><br><span class="line">cs/tethering\_wifi\_help.html:</span><br><span class="line">da/tethering_help.html:</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>We can see the offending code which is being flagged, nothing to do with any of the actual Android parts. We can see this is the actual detected part by just looking it up on VirusTotal.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">champagne:html tstrazzere$ echo -n $&#x27;&#x27; | shasum</span><br><span class="line">3c4e3917661442be9ec92adf6ba5b93989a4dd7e -</span><br></pre></td></tr></table></figure>
<p>Which looking up that sha1 gives us;<br><a target="_blank" rel="noopener" href="https://www.virustotal.com/file/3c1d9f097bbd29904201cb0da37881dcbfad08acee80df883f9bcacf9805cf34/analysis/" title="VirusTotal Analysis Sha1: 3c4e3917661442be9ec92adf6ba5b93989a4dd7e">VirusTotal Analysis Sha1: 3c4e3917661442be9ec92adf6ba5b93989a4dd7e</a><br>So does this seem intentional, or accidental? Was someone actually trying to infect Android devices, or was this just a strange mishap? I’m inclined to believe this was just a strange coincidence, both of the applications are the Android settings application, “com.android.settings” - and signed with the commonly found AOSP debug signer. What appears to have happened, is someone was compiling the AOSP, possibly for a custom ROM, and had these HTML files located on an infected host. The virus then infected these HTML files by injecting the javascript load code, and then these APKs where bundled. We can see that these where actually properly bundled;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">champagne:elad tstrazzere$ jarsigner -verbose -verify com.android.settings_1eaffc274ae549e0ecb4145857ae3fa6ad0fd3c5.apk </span><br><span class="line"></span><br><span class="line">       39208 Wed Apr 16 07:40:50 PDT 2008 META-INF/MANIFEST.MF</span><br><span class="line">       39250 Wed Apr 16 07:40:50 PDT 2008 META-INF/CERT.SF</span><br><span class="line">        1714 Wed Apr 16 07:40:50 PDT 2008 META-INF/CERT.RSA</span><br><span class="line">sm 53588 Wed Apr 16 07:40:50 PDT 2008 AndroidManifest.xml</span><br><span class="line">sm 1710 Wed Apr 16 07:40:50 PDT 2008 assets/html/cs/tethering_help.html</span><br><span class="line">sm 1027 Wed Apr 16 07:40:50 PDT 2008 assets/html/cs/tethering\_usb\_help.html</span><br><span class="line">sm 987 Wed Apr 16 07:40:50 PDT 2008 assets/html/cs/tethering\_wifi\_help.html</span><br><span class="line">sm 1433 Wed Apr 16 07:40:50 PDT 2008 assets/html/da/tethering_help.html</span><br><span class="line">sm 833 Wed Apr 16 07:40:50 PDT 2008 assets/html/da/tethering\_usb\_help.html</span><br><span class="line">sm 904 Wed Apr 16 07:40:50 PDT 2008 assets/html/da/tethering\_wifi\_help.html</span><br><span class="line">sm 1585 Wed Apr 16 07:40:50 PDT 2008 assets/html/de/tethering_help.html</span><br><span class="line">sm 922 Wed Apr 16 07:40:50 PDT 2008 assets/html/de/tethering\_usb\_help.html</span><br><span class="line">…</span><br><span class="line">  s = signature was verified </span><br><span class="line">  m = entry is listed in manifest</span><br><span class="line">  k = at least one certificate was found in keystone</span><br><span class="line">  i = at least one certificate was found in identity scope</span><br><span class="line"></span><br><span class="line">jar verified.</span><br></pre></td></tr></table></figure>
<p>The interesting part is that the signature did verify, meaning that at time of signing for this APK, that javascript file was included. So did this actually do anything to the devices? No - not really, however there might be someone with a custom ROM which has all these files on their device. Since the url’s being added are all long since dead, there shouldn’t any adverse side effects. Though it would appear that the application is going to read the contents of the HTML files in, then load them into an AlertDialog - where that javascript should not actually perform any actions. As a last side note - I did edit the output that is displayed in this blog to be “hxxp” opposed to “http”. When I didn’t do this, even though the scripts where not being executed, Google Safe Browsing was blocking me from ever seeing my own blog :)</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/strazzere">Projects</a></li>
        
      </ul>
    </div>

    
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&text=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&is_video=false&description=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Javascript Malware Cross-Contamination in Android apks&body=Check out this article: https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&title=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&name=Javascript Malware Cross-Contamination in Android apks&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://strazzere.com/2013/02/javascript-malware-cross-contamination-in-android-apks/&t=Javascript Malware Cross-Contamination in Android apks"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2008-2024
    Tim Strazzere
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/strazzere">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
